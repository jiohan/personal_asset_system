# 개인 자산 관리 PWA 개발 가이드

## 1. 제품 목표 (핵심 기능)
이 프로젝트의 핵심 가치는 아래 3가지입니다.

1. 계좌별 입출금 거래 기록
- 거래 내역 저장: 언제/얼마/어디/메모/계좌
- 수동 입력 지원
- CSV/엑셀 업로드 지원 (초기 필수)

2. 세부 분류 체계
- 카테고리: 예) 식비 > 배달, 교통 > 대중교통
- 태그: 예) #데이트, #출장, #정기결제
- 분류 규칙 기반 자동 태깅/추천: 키워드/금액/가맹점 기준

3. 흐름 시각화 및 리포트
- 월별 현금 흐름: 수입-지출(이체는 제외)
- 월별 자금 이동: 이체(계좌 간 이동) 합계, 투자계좌로 이동/회수 합계(선택)
- 카테고리별 지출 Top N
- 계좌별 잔액 추이 및 전월 대비 비교 (고정/정기 분리)

---

## 2. 실행 로드맵 (A안)

### 0단계: MVP 기준 설정
- 핵심 기준: 정리되고, 검색되고, 분류되고, 리포트가 나온다.
- 포함 기능: 거래 입력/수정/삭제, 복수 계좌 관리, 카테고리/태그, 월별/카테고리별 리포트
- 제외 기능(초기): 자동 연동, 영수증 OCR, AI 자동 분류
- 제외 기능(초기, 투자): 종목/매수/매도/배당, 평가손익/수익률, 시세 연동(투자 성과 분석)
- 제외 기능(초기, 선택): 카드/대출 등 부채 모델링(지출 2번 잡힘 방지 룰 포함)

### 1단계: 데이터 유입 경로 구축 (입력)
- 모바일 빠른 수동 입력: 날짜/금액/수입·지출/카테고리/메모
- CSV 업로드: 미리보기 -> 컬럼 매핑 -> 중복 제거 -> 가져오기
- 날짜 파싱 규칙: CSV에 시간이 있어도 최종 저장은 `LocalDate`(date-only). 타임존 변환 드리프트 방지용 기본 타임존을 명시(예: Asia/Seoul).

### 2단계: 분류 시스템 구축 (정리)
- 카테고리: 트리 구조(대/중/소) 또는 2단계
- 태그: 다중 태그 지원
- 분류 규칙: 키워드/날짜/금액/가맹점 기반 자동 분류
- 검토함(인박스): 자동 분류 불확실 항목 일괄 처리

### 3단계: 대시보드 및 리포트 (시각화)
- 대시보드: 이달 수입/지출/순저축(=수입-지출, 이체 제외), 지출 Top 5, 현금흐름 그래프
- 거래내역 리스트: 기간/계좌/카테고리 필터 + 검색
- 리포트: 월별 비교, 카테고리별 비중(파이/막대), 고정비/변동비 집계

### 4단계: PWA 사용성 고도화
- 설치(홈 화면 추가)
- 반복 거래 자동 생성 (구독/월세)
- 예산/목표 설정
- 백업/복원 (내보내기/가져오기)

### 5단계: 모바일 앱 확장 판단
- 확장 신호: 알림/위젯 필요, 영수증 촬영 필요, 오프라인 동기화 중요성 증가
- 전략: 모바일 앱은 간편 입력+조회 중심, 분석은 웹 유지

---

## 3. 추천 기술 스택

### 프론트엔드 (PWA)
- React + TypeScript
- 이유: PWA 구현 용이, 대시보드/데이터 처리 적합
- 대안: Vue+TS(경량), SvelteKit(속도)

### 백엔드 (API)
- Java + Spring Boot
- 이유: 복잡한 규칙/리포트 계산, 인증/배치 확장 안정성

### 데이터베이스
- PostgreSQL 권장
- 이유: 누적 거래 데이터 + 복잡한 집계 쿼리에 강함
- 참고: 초기 SQLite 가능하지만 운영 확장 고려 시 Postgres 선호

### 기타 인프라
- 인증: 이메일+비밀번호(세션/JWT) 또는 Google OAuth 중 하나
- 파일 관리: CSV 업로드/다운로드 + Zip/JSON 백업

---

## 4. 개발 환경 및 구성

### 필수 설치
- JDK 21 (또는 17)
- Node.js LTS
- Git
- Docker Desktop (DB 컨테이너)
- IDE: IntelliJ(백엔드), VS Code(프론트엔드)

### 로컬 구성
- 프론트: 개발 서버 (Hot Reload)
- 백엔드: 로컬 API 서버
- DB: Docker 기반 실행 (환경 통일)

### 추천 레포 구조
```text
/frontend   # PWA
/backend    # Spring Boot API
/infra      # docker-compose, 설정
/README.md  # 개발 규칙
```

---

## 5. 개발 시작 전 최소 설계 고정
아래 4가지는 시작 전에 확정합니다.

1. Account 필드(최소)
- 이름
- 타입: `CASH` | `INVESTMENT` (MVP 고정, 추후 `CREDIT`/`LOAN` 확장 가능)

2. Transaction 필드
- 날짜(`LocalDate`)
- 금액(정수 KRW, 항상 양수)
- 타입: 수입/지출/이체
- 계좌(수입/지출일 때): `accountId`
- 계좌(이체일 때): `fromAccountId`, `toAccountId` (이체는 1건으로 저장)
- 설명(가맹점/메모)
- 카테고리
- 태그
- 원본(수동/CSV)
- 삭제 여부(`deletedAt`)

3. 카테고리 구조
- 2단계(대/소) 또는 3단계 중 하나 선택

4. 리포트 기준(정의)
- 월별 기본
- 계좌별/카테고리별 집계 포함
- 총수입: `INCOME` 합(소프트 삭제 제외)
- 총지출: `EXPENSE` 합(소프트 삭제 제외)
- 순저축: `총수입-총지출` (이체는 포함하지 않음)
- 이체: `TRANSFER` 합은 별도 지표로 표시(수입/지출에 섞지 않음)
- 투자이동(선택): `CASH -> INVESTMENT` 이체 합(회수는 `INVESTMENT -> CASH` 합)
- 잔액 추이: 계좌 단위로는 이체 포함(입금/출금 + 이체 in/out 모두 반영)

---

## 6. 1인 프로젝트 안전장치 (필수 권장)

### A. 이체(Transfer) 개념 초기 도입
- 거래 타입을 수입/지출/이체 3개로 고정
- 이체는 수입/지출 합계에서 제외해 현금흐름 왜곡 방지
- 계좌 잔액 추이 정확도 확보

### B. 백업/복원 1버전 포함
- JSON 내보내기/가져오기 (버전 정보 포함)
- 이유: 데이터 유실 방지, 구조 변경 시 마이그레이션 용이

### C. 삭제 정책은 소프트 삭제
- 하드 삭제 대신 `deletedAt` 사용
- 리포트 정합성 및 복구 가능성 확보

### D. 돈/날짜 기준 문서화
- 금액: 정수(원 단위) 저장
- 날짜: `LocalDate` 사용
- 통화: 초기 버전 KRW 단일 통화

---

## 7. 권장 초기 구현 우선순위 (실행 체크리스트)
- 거래 CRUD + 복수 계좌
- CSV 업로드(매핑/중복 제거)
- 카테고리/태그 + 기본 규칙
- 월별/카테고리 리포트
- JSON 백업/복원
- 소프트 삭제 + 이체 처리

이 6개가 완성되면 MVP 목표인 “정리, 검색, 분류, 리포트”를 충족할 수 있습니다.
